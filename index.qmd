---
title: "ALS processing for forest inventory using `LAStools` and `lidR`"
author:
  - name: "Liam A.K. Irwin"
    affiliation: "Integrated Remote Sensing Studio, University of British Columbia"
  - name: "Brent A. Murray"
    affiliation: "Integrated Remote Sensing Studio, University of British Columbia"
  - name: "Sadie J.S. Russell"
    affiliation: "Integrated Remote Sensing Studio, University of British Columbia"
date: 2025-09-29
---

```{r setup, include=FALSE}
source("R/setup_rgl.R")
```

## People

**Presenters:**

[Liam Irwin (UBC)](https://www.researchgate.net/profile/Liam-Irwin-3)

[Brent Murray (UBC)](https://www.researchgate.net/profile/Brent-Murray-4)

[Sadie Russell (UBC)](https://ca.linkedin.com/in/sadie-russell-556094271)

## Materials

[This repository](https://github.com/liamirwin/SL25_lidRtutorial) contains the material for an 3 hour `lidR` tutorial workshop. You should install the material on your own machine from [this repository](https://github.com/liamirwin/SL25_lidRtutorial). It contains the code and point-clouds we will use. The workshop intends to:

-   Present an overview lidar processing with `LAStools` and `lidR`
-   Give users an understanding of how `LAStools` and `lidR` may fit their needs
-   Exercises will be done depending on available time - users are encouraged to work on these after the workshop!

::: callout-tip
**Introduction slides:** [Intro to Airborne LiDAR, lidR, and LAStools](SL25_lidR_LiDAR_Intro.html)
:::

## Download Workshop Materials

You can download the complete workshop package containing all code, data, and exercises here:

[Download the entire Silvilaser 2025 lidar processing tutorial package (.zip, 296 MB)](https://ln5.sync.com/dl/c7ee36c20#4cs2wj7d-fwqr6ism-jzrbc7ax-m2qes4fy)

[Download only the classified lidar files for 05_engine (.zip, 93 MB)](./data/ctg_class.zip)

[Download only the normalized lidar files for 05_engine (.zip, 94 MB)](./data/ctg_norm.zip)

Unzip the first to a folder, and run the `.Rproj` file with RStudio installed for the easiest experience. 

If only downloading the classified or normalized lidar files, unzip them to the `data` folder your working directory.

![Target Folder and Data Structure for Workshop Contents](img/folder_structure.png)

## Requirements

### R version and Rstudio

-   You need to install a recent version of `R` i.e. `R 4.x` or newer.
-   We will work with [Rstudio](https://www.rstudio.com/). This IDE is not mandatory to follow the workshop but is highly recommended.

### R Packages

::: callout-tip
**Easy setup for new users:** Please open the `SL25_lidRtutorial_package.Rproj` in RStudio. Next, open `01_read.R` to run code to automatically install packages.
:::

Please install the `lidR` package in its latest version (4.2.1/4.2.2).

``` r
install.packages("lidR")
```

To run all code in the tutorial locally, you will need to install the following packages. You can use `lidR` without them or follow along with provided code and outputs.

``` r
libs <- c("terra","viridis","future","sf","mapview")

install.packages(libs)
```

In the metrics section we introduce and work with a user-made package that supports `lidR` with additional functions to generate layers useful in vegetation and biodiversity mapping.

To follow along with these steps; install `lidRmetrics` from GitHub (not available on CRAN), this requires the `devtools` package

``` r
if (!requireNamespace("devtools", quietly = TRUE)) {
  install.packages("devtools")
}

devtools::install_github("ptompalski/lidRmetrics")
```

### Datasets

We will be working with a sample ALS dataset collected in 2016 with a RIEGEL LMS-Q780 over the Forêt Montmorency in Quebec.

This area serves as a research forest for the Université Laval and is managed by the Ministère des Forêts, de la Faune et des Parcs (MFFP) du Quebec.

Quebec ALS data is avaliable for download from the [Ressources naturelles et Faune (RNF) portal](https://geoboutique.mern.gouv.qc.ca/edel/pages/recherche/critereRechercheEdel.faces).

```{r, echo = FALSE}
bdy <- sf::st_read("data/fm_boundary.gpkg", quiet = TRUE)

congres_pt <- sf::st_as_sf(
  data.frame(
    name = "We are here",
    lat = 46.81016858232409,
    lon = -71.21575480959382
  ),
  coords = c("lon", "lat"),
  crs = 4326
)

mapview::mapviewOptions(basemaps = "Esri.WorldImagery")

mapview::mapview(
    bdy,
    layer.name = "Forêt Montmorency",
    col.regions = "blue",
    alpha.regions = 0.2,
    color = "blue",
    lwd = 2,
    alpha = 1.0
  ) +
  mapview::mapview(
    congres_pt,
    layer.name = "SL25 Location",
    col.regions = "red",
    cex = 8,
    alpha = 1.0
  ) 
```

## Workshop schedule {.smaller}

-   Introduction to Lidar, LAStools, and lidR (09:00)
-   Preprocessing with LAStools (9:20)
-   Reading LAS and LAZ files (09:30)
-   Point Classification and Filtering (9:35)
-   Digital Terrain Models and Height Normalization (9:40)
-   Canopy Height Models (9:50)
-   Lidar Summary Metrics (9:55)
-   Break (10:15-10:45)
-   File Collection Processing Engine (10:45)
-   Regions of Interest (11:0)
-   Area Based Approach (11:10)
-   Individual Tree Detection and Segmentation (11:30)
-   Questions (11:50)

## Resources

We strongly recommend having the following resources available to you:

-   The [`lidR` official documentation](https://cran.r-project.org/web/packages/lidR/lidR.pdf)
-   The [lidRbook](https://r-lidar.github.io/lidRbook/) of tutorials

When working on exercises:

-   [Stack Exchange with the `lidR` tag](https://gis.stackexchange.com/questions/tagged/lidr)

## `lidR`

`lidR` is an R package to work with lidar data developed at Laval University (Québec, Canada). It was developed & continues to be maintained by [Jean-Romain Roussel](https://github.com/Jean-Romain) and was made possible between:

-   2015 and 2018 thanks to the financial support of the AWARE project NSERC CRDPJ 462973-14; grantee Prof. Nicholas C. Coops.

-   2018 and 2021 thanks to the financial support of the Ministère des Forêts, de la Faune et des Parcs (Québec).

-   2021 and 2024 thanks to the financial support of Laval University.

The current release version of `lidR` can be found on [CRAN](https://cran.r-project.org/web/packages/lidR/) and source code is hosted on [GitHub](https://github.com/r-lidar/lidR).

::: callout-note
![](img/rlidar_banner.png)

Since 2024, the `lidR` package is no longer supported by Laval University, but the software will remain free and open-source. `r-lidar` has transitioned into a company to ensure sustainability and now offers independent services for training courses, consulting, and development. Please feel free to visit their [website](https://www.r-lidar.com/) for more information.
:::


## `LAStools`

[`LAStools`](https://rapidlasso.de/product-overview/) is a collection of highly efficient, batch-scriptable, multicore command line tools for processing LiDAR data. It was originally developed by Martin Isenburg and is continually developed and improved by a team at rapidlasso.

![](img/lastools.svg){width=30%}

::: callout-note

## Note

`LAStools` is not open-source software, but many of its powerful tools are freely avaliable to use, including those we will use in this workshop.

Other tools require a license for commercial or educational use that can be purchased from rapidlasso.

Please visit the [LAStools website](https://rapidlasso.de/downloads/) for more information on how to download and install the software.

The inital processing steps we will use in this workshop can be completed with the free version of `LAStools`, or you can make use of the pre-processed data provided in the workshop materials package.
:::